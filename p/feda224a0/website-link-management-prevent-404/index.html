<!doctype html><html lang=zh-cn><head><meta name=color-scheme content="dark"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.139.4"><meta name=description content="互联网的世界，一刻亿变。而有些 URL，变着变着就成为了 404。
如何防止个人网站因即技术或结构变更而导致同一页面的旧 URL 失效而 404？本文对此进行简单讨论。
"><meta property="og:title" content="浅谈网站 URL 管理与预防 404"><meta property="og:description" content="互联网的世界，一刻亿变。而有些 URL，变着变着就成为了 404。
如何防止个人网站因即技术或结构变更而导致同一页面的旧 URL 失效而 404？本文对此进行简单讨论。
"><meta property="og:image:url" content="https://blog.celestialy.top/p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404_hu10980808641272292395.webp"><meta property="og:image:width" content="1200"><meta property="og:image.height" content="675"><meta property="og:image:type" content="image/webp"><meta property="og:url" content="https://blog.celestialy.top/p/feda224a0/website-link-management-prevent-404/"><meta property="og:site_name" content="clsty 的网络空间站"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-05-07T12:34:00+08:00"><meta property="article:modified_time" content="2024-05-17T00:00:00+08:00"><meta property="article:tag" content="hugo"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.celestialy.top/p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404_hu10980808641272292395.webp"><meta name=twitter:title content="浅谈网站 URL 管理与预防 404"><meta name=twitter:description content="互联网的世界，一刻亿变。而有些 URL，变着变着就成为了 404。
如何防止个人网站因即技术或结构变更而导致同一页面的旧 URL 失效而 404？本文对此进行简单讨论。
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"NewsArticle","dateModified":"2024-05-17T00:00:00+08:00","datePublished":"2024-05-07T12:34:00+08:00","headline":"浅谈网站 URL 管理与预防 404","image":["https://blog.celestialy.top/p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404_hu10980808641272292395.webp"]}</script><title>浅谈网站 URL 管理与预防 404 | clsty 的网络空间站
</title><link rel=preload href=/IBM-Plex-Sans/fonts/split/woff2/IBMPlexSans-Bold-Latin1.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/IBM-Plex-Sans/fonts/split/woff2/IBMPlexSans-Regular-Latin1.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/IBM-Plex-Sans-Condensed/fonts/split/woff2/IBMPlexSansCondensed-Light-Latin1.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/IBM-Plex-Sans-Condensed/fonts/split/woff2/IBMPlexSansCondensed-Text-Latin1.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/IBM-Plex-Sans-Condensed/fonts/split/woff2/IBMPlexSansCondensed-SemiBold-Latin1.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/fontfaces.min.5442583bc9892da790ae4dfc5e0be3a914b9a11806fc02b0c0ed61f0456e76a1.css integrity="sha256-VEJYO8mJLaeQrk38XgvjqRS5oRgG/AKwwO1h8EVudqE=" media=screen><link rel=stylesheet href=/css/screen.min.b2bfc25fa5b5fb7d7ff2571c70968e348a33f0811b9739e6c79eaba594c86eb2.css integrity="sha256-sr/CX6W1+31/8lcccJaONIoz8IEblznmx56rpZTIbrI=" media=screen><link rel=stylesheet href=/css/custom.min.aee6477538ab4ab378a04100067edf126d56e3a31c3c58987fd57d65953d1cc9.css integrity="sha256-ruZHdTirSrN4oEEABn7fEm1W46McPFiYf9V9ZZU9HMk=" media=screen><script src=/js/ls.min.6caaaee2899d2d0bb2cd66e696389981f80744632f18ac48f14a6b0f559c46bd.js integrity="sha256-bKqu4omdLQuyzWbmljiZgfgHRGMvGKxI8UprD1WcRr0=" async></script><link rel=icon type=image/svg+xml href=/favicon/favicon.svg><link rel=icon type=image/png href=/favicon/favicon.png><link rel=stylesheet href=/css/pagestyle/post.css integrity media=screen></head><body><script>let FF_FOUC_FIX</script><header class="l-masthead l-nav" id=l-masthead><div class="ctrl ctrl-left" id=l-logo><a class="ctrl__title ctrl__title--text nav__title" href=https://blog.celestialy.top/><span>clsty 的网络空间站</span></a></div><div class="ctrl ctrl-left" id=l-menu><nav><ul class=ul--row><li><a class="ctrl__menulink nav-main__link" href=/>❀新鲜事❀</a></li><li><a class="ctrl__menulink nav-main__link has-active" href=/blog/>❈散文屋❈</a></li><li><a class="ctrl__menulink nav-main__link" href=/doc/>❉文档馆❉</a></li><li><a class="ctrl__menulink nav-main__link" href=/authors/>・人・</a></li><li><a class="ctrl__menulink nav-main__link" href=/categories/>〈  类别</a></li><li><a class="ctrl__menulink nav-main__link" href=/series/>|  系列  |</a></li><li><a class="ctrl__menulink nav-main__link" href=/tags/>标签  〉</a></li></ul></nav></div><div class="ctrl ctrl-right" id=l-ctrl><nav><ul class=ul--row></ul></nav><a href=/search/ id=search class=ctrl__button title="Open search"><span class='icon icon--material icon--normal'><svg viewBox="0 0 24 24"><path d="m19.55 20.575-6.3-6.275q-.75.625-1.725.975t-2 .35q-2.575.0-4.35-1.775Q3.4 12.075 3.4 9.5q0-2.55 1.775-4.338 1.775-1.787 4.35-1.787 2.55.0 4.325 1.775 1.775 1.775 1.775 4.35.0 1.075-.35 2.05-.35.975-.95 1.7l6.275 6.275zm-10.025-6.45q1.925.0 3.263-1.35 1.337-1.35 1.337-3.275.0-1.925-1.337-3.275-1.338-1.35-3.263-1.35-1.95.0-3.287 1.35Q4.9 7.575 4.9 9.5t1.338 3.275q1.337 1.35 3.287 1.35z"/></svg></span>
</a><button id=toggle-toc class=ctrl__button aria-label="Toggle TOC" title=开/关导航目录><span class="icon icon--material"></span></button><aside class=is-closed id=toc><div class=toc__box><div class=toc__content><nav class=toc__list><h2 class=toc__title><a href=#l-content-box class=nav__link>在此页面上</a></h2><ul><li class="nav__item nav__item--2"><a href=/p/feda224a0/website-link-management-prevent-404/#%e5%ba%8f>序</a></li><li class="nav__item nav__item--2"><a href=/p/feda224a0/website-link-management-prevent-404/#%e6%96%b9%e6%a1%88%e5%af%b9%e6%af%94>方案对比</a><ul><li class="nav__item nav__item--3"><a href=/p/feda224a0/website-link-management-prevent-404/#slug>slug</a></li><li class="nav__item nav__item--3"><a href=/p/feda224a0/website-link-management-prevent-404/#url-%e4%b8%8e%e7%bc%96%e5%8f%b7>URL 与编号</a></li><li class="nav__item nav__item--3"><a href=/p/feda224a0/website-link-management-prevent-404/#%e7%bc%96%e5%8f%b7%e4%bd%9c%e4%b8%ba-slug-%e7%9a%84%e8%a1%a5%e5%85%85>编号作为 slug 的补充</a></li><li class="nav__item nav__item--3"><a href=/p/feda224a0/website-link-management-prevent-404/#%e7%bc%96%e5%8f%b7%e4%b8%8e-slug-%e7%9a%84%e7%9c%9f%e6%ad%a3%e7%bb%93%e5%90%88>编号与 slug 的真正结合</a><ul><li class="nav__item nav__item--4"><a href=/p/feda224a0/website-link-management-prevent-404/#%e6%80%9d%e8%b7%af>思路</a></li><li class="nav__item nav__item--4"><a href=/p/feda224a0/website-link-management-prevent-404/#%e5%81%87%e5%a6%82%e8%83%bd%e4%b8%ba-alias-%e4%bd%bf%e7%94%a8%e9%80%9a%e9%85%8d%e7%ac%a6>假如能为 alias 使用通配符</a></li><li class="nav__item nav__item--4"><a href=/p/feda224a0/website-link-management-prevent-404/#%e9%82%a3%e4%b9%88%e4%b8%ba%e4%bb%80%e4%b9%88>那么为什么……？</a></li><li class="nav__item nav__item--4"><a href=/p/feda224a0/website-link-management-prevent-404/#%e5%85%b7%e4%bd%93%e5%ae%9e%e7%8e%b0>具体实现</a></li><li class="nav__item nav__item--4"><a href=/p/feda224a0/website-link-management-prevent-404/#%e5%8f%a6%e4%b8%80%e7%a7%8d%e6%96%b9%e6%b3%95>另一种方法</a></li></ul></li></ul></li><li class="nav__item nav__item--2"><a href=/p/feda224a0/website-link-management-prevent-404/#%e7%bb%88>终</a></li></ul></nav></div></div></aside></div></header><div class=l-page><main id=l-main class=l-tnp><div id=l-content-box class="l-box l-box--full"><article id=l-content data-pagefind-body><header class=page-header><div class="meta meta--head meta--left" data-pagefind-ignore><ul class=meta__list><li class="taxo-shape taxo-shape--category"><ul class=ul--row><li class=meta__hanging><a class="link link--nav" href=/categories/ title="All Categories"><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="m5.042 9.479 4.979-8.146L15 9.479zm9.666 9.167q-1.646.0-2.791-1.156-1.146-1.157-1.146-2.782.0-1.646 1.146-2.791 1.145-1.146 2.791-1.146 1.625.0 2.782 1.146 1.156 1.145 1.156 2.791.0 1.625-1.156 2.782-1.157 1.156-2.782 1.156zm-12.583-.417v-7.062h7.063v7.062z"/></svg></span></a></li><li class="meta__item meta__item--taxo"><a class="meta__text link link--nav" href=/categories/method/>方法论</a></li></ul></li><li class="taxo-shape taxo-shape--tag"><ul class=ul--row><li class=meta__hanging><a class="link link--nav" href=/tags/ title="All Tags"><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M3.188 10.542v5.875L.917 15.5zm4.062 7.75h-2.5V11.5zm1.958.75L4.146 5.333 14 1.75l5.042 13.729zm.021-10.5q.396.0.677-.282.282-.281.282-.677.0-.375-.282-.656-.281-.281-.677-.281-.375.0-.656.281t-.281.656q0 .396.281.677.281.282.656.282z"/></svg></span></a></li><li class="meta__item meta__item--taxo"><a class="meta__text link link--nav" href=/tags/hugo/>Hugo</a></li></ul></li></ul><div class=published><ul class=author-list><li><a href=/authors/clsty/ title=clsty><figure class="fig fig--w-pt2 fig--portrait-small"><span class=img__frame style=display:flex;justify-content:center;align-items:center><span class=img__c style=position:relative;width:100%;height:0;padding-bottom:100%><img alt=clsty class=img--ls height=72 loading=lazy src="data:image/webp;base64,UklGRkgCAABXRUJQVlA4IDwCAAAwDgCdASpIAEgAPsFUn0mjoiEVKQVoOwwE8YBp/L/eZ9CO2d8QD1h/QBvM28235LN4Vk8svSjs6Fb6zbtoFupI+dyFeHplFKUSKUQDVvDi8N4Vg76O3JleX3A4xIhix9JIEU8iT97aQ5E1I4HgSgdDnp60J1vOSOnkgAD+uQGW+hjWGjqOFsHcZH5SA82lA83PBwgmufC2F6vBy4l89pPa5Tk/ge0qz0CAF7cdNrwSj3KredZ3cqj5yuIT5Jzs1ltOE/JGg1TcTyCC2gVB6hOJMUXt1oDgg4WFIMiW8bNy8c4X9yCvqFYxpi5p4Age+NgYWtvJ+jGBNND+2ubtCcC6Zn7O7WkPHFy5txHndLP8WmCBj7EoKu700UkRerNoHdKaJVozRqdAvKZJkS8R7U3j6LehJ0vL1OMUHZgjr9gpqgl1VLMatnsGTsRL0ZlBYjsFaxSL6/hqvDK9Nkgv+VenWkY/So/b3m+FK6/VVuxdWNmj8sdYkPJaNRuqtZ/Cz97ZjA/35KiLFcucippxCbFujE54ortYig4opBeQzn/RpHBi8mplK6ByyTcg1wgm/y//cYXt6X5kSGLXI/PQMd5KTLwNIkRsEFR6gKnjrTUL8xWMeBifouQe3I2PfJ/oTipzEMwKhPlfHRst/85ewVJNqDCkSbuMg4MEGDCuUXMFMuB+Qle7KBrvokrxctCBwMgoGZN5CitFJ69TVKWX6GsxIdsQqn1l8WFEW7SlnfghraN1tEJauXUAA1iAAA==" width=72></span></span></figure></a></li></ul><ul class="meta__list meta__list--date"><li class=meta__item><span class=meta__icon><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M12.021 14.938q-.896.0-1.521-.615t-.625-1.49q0-.895.625-1.521.625-.624 1.521-.624.875.0 1.489.624.615.626.615 1.521.0.875-.615 1.49-.614.615-1.489.615zM2.333 18.5V3.25h2.584V1.5h1.875v1.75h6.416V1.5h1.875v1.75h2.584V18.5zm1.979-1.979h11.376V8.375H4.312z"/></svg></span>
</span><time class=meta__text datetime=2024-05-07T12:34:00+08:00>May 7, 2024</time></li><li class="meta__item meta__date"><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M10 18.5q-1.771.0-3.323-.667-1.552-.666-2.698-1.812t-1.812-2.698Q1.5 11.771 1.5 10t.667-3.323q.666-1.552 1.812-2.698t2.698-1.812Q8.229 1.5 10 1.5t3.323.667q1.552.666 2.698 1.812t1.812 2.698Q18.5 8.229 18.5 10t-.667 3.323q-.666 1.552-1.812 2.698t-2.698 1.812Q11.771 18.5 10 18.5zm2.583-4.562 1.375-1.355-3-2.979V5.896H9.042v4.458z"/></svg></span>
<span class=meta__text>12:34 pm</span></li></ul></div></div><div class="title title--sans margin-full"><h1 data-pagefind-weight=10>浅谈网站 URL 管理与预防 404</h1></div><aside class=featured-image><figure class="fig fig--ph-right fig--w-small fig--featured"><span class="img__frame img__frame--box-shadow" style="display:flex;justify-content:center;align-items:center;background-image:linear-gradient(to right,#23201c,#bab3a6)"><span class=img__c style=position:relative;width:100%;height:0;padding-bottom:80%><img alt=featured class="img--ls img--ph lazyload" data-optimumx=auto data-sizes=auto data-srcset="/p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-256x.webp 256w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-285x.webp 285w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-317x.webp 317w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-330x.webp 330w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-353x.webp 353w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-394x.webp 394w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-438x.webp 438w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-488x.webp 488w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-543x.webp 543w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-605x.webp 605w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-674x.webp 674w, /p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-750x.webp 750w" height=264 src=/p/feda224a0/website-link-management-prevent-404/pic.featured/http.cat.404-330x.webp srcset=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 width=330></span></span><figcaption class=caption><span class=caption__attr data-pagefind-ignore>(<a class="link link--text" href=https://github.com/httpcats/http.cat/blob/master/public/images/404.jpg>github:httpcats/http.cat</a>)</span></figcaption></figure></aside></header><div class="md md--sans md--h-sans md--margin-full"><style>.wordcount-label{font-size:16px;text-align:right}</style><span class=wordcount-label>字词数：4768&nbsp;&nbsp;&nbsp;✧&nbsp;&nbsp;&nbsp;</span><style>.pageviews-label{font-size:16px;text-align:right}</style><span class=pageviews-label>阅读量：<span class=pageviews-label id=ArtalkPV></span>&nbsp;&nbsp;&nbsp;✧&nbsp;&nbsp;</span>
<time id=LastmodTime datetime=2024-5-17></time>
<span id=expiredTip class=expiredTip-label></span><style>.expiredTip-label{font-size:16px}</style><script>function GetNumberOfDays(e,t){var n=Date.parse(new Date(e)),s=Date.parse(new Date(t)),o=parseInt((s-n)/(1e3*60*60*24));return o}var date=new Date,ny=date.getFullYear(),nm=date.getMonth()+1,nd=date.getDate(),a1=document.getElementById("LastmodTime").dateTime,a2=ny+"-"+nm+"-"+nd,num=GetNumberOfDays(a1,a2),str1="最近更新：距今",str2="日";document.getElementById("expiredTip").innerHTML=str1+"&nbsp;"+num+"&nbsp;"+str2</script><div id=permaportalValue style=display:none>feda224a0</div><p class=box style=white-space:nowrap;font-size:1.2em;overflow-x:auto;clear:none>以下按钮可供你方便地引用本文。URL 中即使域名变化，其后的路径也将始终指向原本的内容。
<script>function copyToClipboard(e,t){var n,s,o=document.getElementById(e).innerText;navigator.clipboard.writeText(o),n=document.getElementById(t),s=n.textContent,n.textContent="✓ 已复制",setTimeout(function(){n.textContent=s},1200)}</script><br><button id=permaportal-button onclick='copyToClipboard("permaportallink","permaportal-button")' class=permaportal--button>单击复制</button>
<span id=permaportallink class=permaportal--linkbox>https://blog.celestialy.top/p/feda224a0</span><br><button id=permaportal-button-md onclick='copyToClipboard("permaportallink-md","permaportal-button-md")' class=permaportal--button>markdown</button>
<span id=permaportallink-md class=permaportal--linkbox>[浅谈网站 URL 管理与预防 404 | clsty 的网络空间站](https://blog.celestialy.top/p/feda224a0)</span><br><button id=permaportal-button-org onclick='copyToClipboard("permaportallink-org","permaportal-button-org")' class=permaportal--button>org-mode</button>
<span id=permaportallink-org class=permaportal--linkbox>[[https://blog.celestialy.top/p/feda224a0][浅谈网站 URL 管理与预防 404 | clsty 的网络空间站]]</span></p><p class=p-first>互联网的世界，一刻亿变。而有些 URL，变着变着就成为了 404。</p><p>如何防止个人网站因即技术或结构变更而导致同一页面的旧 URL 失效而 404？本文对此进行简单讨论。</p><p>注：本文仅以 Hugo 作为具体实现的例子，而各方案的设计理念则并不局限于 Hugo。</p><h2 id=序><a class=h-a href=#%e5%ba%8f>序</a></h2><p>404 是最常见的 HTTP 状态码之一，它表示“Not Found”，通常意味着链接对应的页面不（再）存在。</p><p>笔者在阅读文章时，常会翻阅其中的参考链接，偶尔会遇到 404 报错。</p><ul><li>常见原因例如，网站关停，域名变更，页面被移除，等等。</li><li>但也有一种本应当能避免的 404：网站正常运行，域名没有变化，文章依然存活，但是页面的 URL 路径更新了。<ul><li>这种情形常见于个人网站，且年代越是久远则越容易发生。</li><li>而博客园、知乎等内容平台上文章的 URL 则相对稳定，404 的原因主要是文章被删除<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</li></ul></li></ul><p>因此，在搭建网络空间站时，笔者就在考虑解决这个问题的方案。也即，我希望自己的文章不会因为名称变化<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>、结构变化<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>等原因，使得别人引用本文的链接变成 404。</p><h2 id=方案对比><a class=h-a href=#%e6%96%b9%e6%a1%88%e5%af%b9%e6%af%94>方案对比</a></h2><h3 id=slug><a class=h-a href=#slug>slug</a></h3><p>在网络（web）上，slug<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> 是页面 URL 中按 <code>/</code> 划分的最后一个部分，它通常用小写字母或数字以及连字符组成，比如 <code>https://example.com/articles/latest/how-to-keep-fit</code> 其中的 <code>how-to-keep-fit</code> 就是 slug。</p><p>Hugo 可以为每个页面单独指定 slug。</p><p>比如下面示例导言区所生成的页面，就具有形如 <code>https://example.com/articles/latest/emacs-org-better-latex</code> 的 URL：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-0-1><a class=lnlinks href=#hl-0-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-0-2><a class=lnlinks href=#hl-0-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Text Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-0-3><a class=lnlinks href=#hl-0-3>3</a></span><span class=cl><span class=w></span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=l>emacs-org-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-0-4><a class=lnlinks href=#hl-0-4>4</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>这样做的所谓的“好处”之一是，URL 友好易读，不需要网页的标题就能得知所链接的页面的主题。</p><p>不过，尽管 slug 在很多资料中被高度认可（尤其是英语网站），我们需要认识到，它的这种好处是存疑的。</p><ul><li>首先，不靠网页标题就得知链接页面主题，并不算是一个很有必要的特性。相反，假设某个笔记软件限制人们为链接添加标题或注释性文本，通常只能说明它的这个功能非常有局限性。</li><li>其次，slug 只能使用英语或拉丁语，对于非英语使用者可能根本算不上易读。</li></ul><p>而 slug 与本文主题相关的优点是，它与标题相互独立 —  — 你在变动标题时，不会导致路径也发生变动，所以用 slug 定义的路径是相对稳定的。</p><p>但是，这种稳定性非常有限，因此这个方案仍然会导致以下的一些问题。</p><p><strong>与标题类似，slug 仍然是对页面内容的概括。</strong></p><p>假设你写了一篇文章来说明在 Emacs Org-mode 中优化 LaTeX 工作流的一种方法，这个 slug 就可以叫做 <code>emacs-org-better-latex</code> 。而这样一个含义过于具体的 URL 路径，可能随文章更新而与实际内容脱节。为了解除这种脱节，就又需要更新 slug，这就导致路径变动，使得旧的链接返回 404。</p><p>比如对于上面假设的那篇文章，你又发现了它稍加拓展就能对 Emacs 中的各种 Text Mode 都适用，比如 AucTeX、Markdown 等等，于是你将 slug 更新为 <code>emacs-text-better-latex</code> —  — 此时旧的 slug 即 <code>emacs-org-better-latex</code> 就失效了。</p><p><strong>slug 本身仅针对 URL 路径的最后一部分。</strong></p><p>如果你的文档形成了某种组织结构，每一篇文档都是“路径树”的某个分支下的一片叶子，一旦你需要调整这篇叶子的位置，或者调整这棵树本身，都会导致 URL 的路径变动<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>（旧的链接从此 404），对此 slug 也是无能为力的。</p><p>在计算机领域有句话叫做“面向接口编程，而非面向实现编程”<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>。
slug 所存在的问题本质上亦与之类似：过于具体，而不够抽象。</p><h3 id=url-与编号><a class=h-a href=#url-%e4%b8%8e%e7%bc%96%e5%8f%b7>URL 与编号</a></h3><p>就 slug 存在的问题去思考，我们可以很直接地得到解决方法：不再使用 slug，而是使用与内容毫无关联的“编号”作为 URL 路径的最后一部分，而整个站点中 URL 的前面所有部分都可以统一，比如 <code>https://example.com/posts/编号</code> 。</p><p>只要是与页面的后续变化解耦、不会重复、可以自动生成的字符串，都适合用作编号，比如：</p><ul><li>随机字符串</li><li>首次发布时间</li><li>从 1 开始的递增数</li></ul><p>Hugo 也支持为每个页面单独指定 URL，例如为了让某个页面具有形如 <code>https://example.com/posts/2022-02-22.22.22.22</code> 的 URL，则其导言区可以是：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-1-1><a class=lnlinks href=#hl-1-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-1-2><a class=lnlinks href=#hl-1-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Org Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-1-3><a class=lnlinks href=#hl-1-3>3</a></span><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>/posts/2022-02-22.22.22.22</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-1-4><a class=lnlinks href=#hl-1-4>4</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>这个方案可以轻松解决 slug 带来的问题。</p><ul><li>每个 URL 在表面的含义上均与页面内容无关，所以也不必随内容的主题改变而变动，更不会导致 404。</li><li>这种固定结构的 URL 并不妨碍你用文档树来组织页面，因为在 Hugo 中，除非明确指定 URL，否则 URL 是由文档树结构所“决定”<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>的，而并不是由 URL 反过来决定文档树结构。<ul><li>那么决定文档树的组织是什么呢？答案是导言区的 menu 参数。</li><li>每个父母节点都具有参数 <code>menu.identifier</code>，而要将某个页面作为它的子节点则只需要让这个页面的 <code>menu.parent</code> 的值与父母节点的 <code>menu.identifier</code> 的值相同。</li><li>通过这种机制，就能在目录里形成树状的组织结构，它并不影响我们显式地指定页面的 URL。</li></ul></li></ul><h3 id=编号作为-slug-的补充><a class=h-a href=#%e7%bc%96%e5%8f%b7%e4%bd%9c%e4%b8%ba-slug-%e7%9a%84%e8%a1%a5%e5%85%85>编号作为 slug 的补充</a></h3><p>为 URL 启用编号已经是相当方便且稳定的解决方案了；但有一些人可能还是喜欢 slug 的一些特性，想着“我全都要”。</p><p>对此，Hugo 的 alias 提供了一种解决方案。</p><ul><li>每个页面都可以在导言区配置多个 alias 路径，置于参数 aliases 中。</li><li>当浏览器访问任一个 alias 链接时，都会跳转（被重定向）到页面本身的固有地址。<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup></li></ul><p>如下示例导言区所生成的页面，具有形如 <code>https://example.com/articles/latest/emacs-org-better-latex</code> 的固有地址，也同时具有会被重定向到固有地址的跳转链接 <code>https://example.com/posts/2022-02-22.22.22.22</code> ：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-2-1><a class=lnlinks href=#hl-2-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-2><a class=lnlinks href=#hl-2-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Text Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-3><a class=lnlinks href=#hl-2-3>3</a></span><span class=cl><span class=w></span><span class=nt>slug</span><span class=p>:</span><span class=w> </span><span class=l>emacs-text-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-4><a class=lnlinks href=#hl-2-4>4</a></span><span class=cl><span class=w></span><span class=nt>aliases</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-5><a class=lnlinks href=#hl-2-5>5</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-2-6><a class=lnlinks href=#hl-2-6>6</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>这样一来，不仅固有地址使用 slug 变得“可读”了起来，也可以在页面开头提醒用户引用跳转链接来防止 404。</p><p>但是，这样做表面上两全其美，实际上会引出一些更麻烦的问题：</p><ul><li>为了让用户确实地引用那个跳转链接，而不是显示在浏览器地址栏里的固有地址，如前面所提到的，你需要非常醒目地在页面中告知用户“请使用跳转链接来引用/收藏”，还需要写出理由 —  — 这无疑降低了交互体验。</li><li>浏览器的收藏功能以及部分插件会默认使用地址栏里的 URL 即固有地址，而用户现在只能手动将它改为你的跳转链接了。在大多数情况下，这非常麻烦。</li><li>当用户在其他网站上发贴时，所粘贴的跳转链接可能会被网站提供的在线编辑器自动重定向到固有地址。</li><li>最为关键的是，在地址栏之外，slug 的优点仅在用户放弃 URL 稳定性、接受 404 风险、进而选择了固有地址的前提下才能有所体现 —  — 这真的是“两全其美”吗？<sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup></li></ul><h3 id=编号与-slug-的真正结合><a class=h-a href=#%e7%bc%96%e5%8f%b7%e4%b8%8e-slug-%e7%9a%84%e7%9c%9f%e6%ad%a3%e7%bb%93%e5%90%88>编号与 slug 的真正结合</a></h3><p>前面在由编号作为 slug 补充的方案中，我们只是简单地添加含编号 URL 到 aliases 中，而固有地址仍采用 slug，并且导致了不少问题。</p><h4 id=思路><a class=h-a href=#%e6%80%9d%e8%b7%af>思路</a></h4><p>下面我们对这种方案进行改进，让编号与 slug 的优点更紧密地结合起来。<sup id=fnref:10><a href=#fn:10 class=footnote-ref role=doc-noteref>10</a></sup></p><ul><li>将这样一个同时包含编号与 slug 的 URL 作为固有地址： <code>https://example.com/posts/2022-02-22.22.22.22/emacs-org-better-latex</code></li><li>当 slug 内容与固定地址的不一致时（比如变成 <code>https://example.com/posts/2022-02-22.22.22.22/emacs-text-better-latex</code> 时），始终跳转到固定地址。</li></ul><p>这样一来，也就能同时实现可读性，以及预防 404 的稳定性了。</p><h4 id=假如能为-alias-使用通配符><a class=h-a href=#%e5%81%87%e5%a6%82%e8%83%bd%e4%b8%ba-alias-%e4%bd%bf%e7%94%a8%e9%80%9a%e9%85%8d%e7%ac%a6>假如能为 alias 使用通配符</a></h4><p>思路俱备，只欠实现。</p><p><strong>假如</strong>我们能为 alias 使用通配符的话，可以这样写导言区：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-3-1><a class=lnlinks href=#hl-3-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-2><a class=lnlinks href=#hl-3-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Text Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-3><a class=lnlinks href=#hl-3-3>3</a></span><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>/posts/2022-02-22.22.22.22/emacs-text-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-4><a class=lnlinks href=#hl-3-4>4</a></span><span class=cl><span class=w></span><span class=nt>aliases</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-5><a class=lnlinks href=#hl-3-5>5</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-6><a class=lnlinks href=#hl-3-6>6</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22/*</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-3-7><a class=lnlinks href=#hl-3-7>7</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>但实际上 Hugo 不支持 alias 通配符，因为 alias 的实现原理是在指定路径生成一个 HTML 文件，并在文件中实现跳转。对于通配符来说，<strong>需要生成的 HTML 文件数量几乎是无限个</strong><sup id=fnref:11><a href=#fn:11 class=footnote-ref role=doc-noteref>11</a></sup>，这是不切实际的。</p><h4 id=那么为什么><a class=h-a href=#%e9%82%a3%e4%b9%88%e4%b8%ba%e4%bb%80%e4%b9%88>那么为什么……？</a></h4><p>说到这里，你可能会意识到，本方案可能无法单方面地从静态站点或者说 Hugo 这一侧来解决，而需要考虑配置后端的软件（nginx、apache 等）或平台（GitHub Pages 等），因为利用它们才能实现<strong>作用于无数种可能性之上的</strong>跳转规则。</p><p>但是，如果你对静态站点的 404 配置有一定经验，你可能会意识到一个奇怪的事实：</p><p><strong>既然如此，为什么我们可以自定义 404 页面呢？</strong>
要知道，<code>404</code> 本身只是由 HTTP 协议所返回的状态码，它并不必然意味着任何跳转。这里的跳转必然对应着某种规则，而它显然不是由 Hugo 用类似于 alias 的机制实现的，而只能是 —  — </p><p>是的，这正是由后端软件或平台所实现的跳转规则。</p><ul><li>例如，若需要让 nginx 使用自定义 404 页面，则需添加配置 <code>error_page 404 = /404.html;</code> ；</li><li>而大部分的静态站点托管平台（如 GitHub Pages）则默认启用类似的规则，所以不需要你手动配置。</li></ul><h4 id=具体实现><a class=h-a href=#%e5%85%b7%e4%bd%93%e5%ae%9e%e7%8e%b0>具体实现</a></h4><p>这就给了我们一个思路：我们可以在 404 页面用 Javascript 来处理链接，实现跳转规则。</p><p>以 Hugo 为例，首先编辑你在 <code>/content</code> 目录下所有文章的导言区，<sup id=fnref:12><a href=#fn:12 class=footnote-ref role=doc-noteref>12</a></sup></p><ul><li>确保每篇文章的 URL 路径都为 <code>/posts/编号/slug</code> ，</li><li>且列表 aliases 至少含有一个元素 <code>/posts/编号</code> 。</li><li>当然，你需要根据文章将上面所说的“编号”和“slug”替换为正确的值。</li></ul><p>例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-4-1><a class=lnlinks href=#hl-4-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-2><a class=lnlinks href=#hl-4-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Text Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-3><a class=lnlinks href=#hl-4-3>3</a></span><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>/posts/2022-02-22.22.22.22/emacs-text-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-4><a class=lnlinks href=#hl-4-4>4</a></span><span class=cl><span class=w></span><span class=nt>aliases</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-5><a class=lnlinks href=#hl-4-5>5</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-4-6><a class=lnlinks href=#hl-4-6>6</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>请仔细检查，确保链接已正确工作（比如试着访问 <code>https://example.com/posts/2022-02-22.22.22.22</code> 看看会不会跳转到固有地址 <code>https://example.com/posts/2022-02-22.22.22.22/emacs-text-better-latex</code>），再继续以下步骤。</p><p>新建 <code>/layouts/404.html</code> ，内容如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln id=hl-5-1><a class=lnlinks href=#hl-5-1> 1</a></span><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-2><a class=lnlinks href=#hl-5-2> 2</a></span><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;{{ .Site.LanguageCode }}&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-3><a class=lnlinks href=#hl-5-3> 3</a></span><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-4><a class=lnlinks href=#hl-5-4> 4</a></span><span class=cl>    {{- partial &#34;head.html&#34; . -}}
</span></span><span class=line><span class=ln id=hl-5-5><a class=lnlinks href=#hl-5-5> 5</a></span><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>utf-8</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-6><a class=lnlinks href=#hl-5-6> 6</a></span><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>robots</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;noindex&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-7><a class=lnlinks href=#hl-5-7> 7</a></span><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-8><a class=lnlinks href=#hl-5-8> 8</a></span><span class=cl>      <span class=kd>var</span> <span class=nx>currentPath</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>pathname</span><span class=p>;</span>
</span></span><span class=line><span class=ln id=hl-5-9><a class=lnlinks href=#hl-5-9> 9</a></span><span class=cl>      <span class=kd>var</span> <span class=nx>regex</span> <span class=o>=</span> <span class=sr>/\/posts\/([^\/]+)\/([^\/]+)\/?/</span><span class=p>;</span>
</span></span><span class=line><span class=ln id=hl-5-10><a class=lnlinks href=#hl-5-10>10</a></span><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>regex</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>currentPath</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=ln id=hl-5-11><a class=lnlinks href=#hl-5-11>11</a></span><span class=cl>        <span class=kd>var</span> <span class=nx>matches</span> <span class=o>=</span> <span class=nx>currentPath</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=nx>regex</span><span class=p>);</span>
</span></span><span class=line><span class=ln id=hl-5-12><a class=lnlinks href=#hl-5-12>12</a></span><span class=cl>        <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=s2>&#34;/posts/&#34;</span> <span class=o>+</span> <span class=nx>matches</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=ln id=hl-5-13><a class=lnlinks href=#hl-5-13>13</a></span><span class=cl><span class=c1>//    } else { window.location.href = &#34;/404-error/&#34;;
</span></span></span><span class=line><span class=ln id=hl-5-14><a class=lnlinks href=#hl-5-14>14</a></span><span class=cl><span class=c1></span>      <span class=p>}</span>
</span></span><span class=line><span class=ln id=hl-5-15><a class=lnlinks href=#hl-5-15>15</a></span><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-16><a class=lnlinks href=#hl-5-16>16</a></span><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-17><a class=lnlinks href=#hl-5-17>17</a></span><span class=cl>  <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-18><a class=lnlinks href=#hl-5-18>18</a></span><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-19><a class=lnlinks href=#hl-5-19>19</a></span><span class=cl>      404 Not Found.
</span></span><span class=line><span class=ln id=hl-5-20><a class=lnlinks href=#hl-5-20>20</a></span><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-21><a class=lnlinks href=#hl-5-21>21</a></span><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln id=hl-5-22><a class=lnlinks href=#hl-5-22>22</a></span><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>最后，如果你已在 <code>/content</code> 目录下自定义了 404 页面，则它优先于 <code>/layouts/404.html</code> ，会使之失效。为了解决这个问题，请依次执行以下步骤：</p><ul><li>去掉 <code>/layouts/404.html</code> 中 <code>} else { window.location.href = "/404-error/";</code> 这一行开头的注释符号<sup id=fnref:13><a href=#fn:13 class=footnote-ref role=doc-noteref>13</a></sup>。</li><li>将自定义 404 页面在 content 目录下的路径从 <code>/content/404/</code> 改为 <code>/content/404-error/</code>，或从 <code>/content/404.md</code> 改为 <code>/content/404-error.md</code>。</li><li>在自定义 404 页面的 Markdown 源文件的导言区，指定参数 <code>url</code> 的值为 <code>/404-error</code>，并且确保没有多余的 alias 占用 <code>/404.html</code> 或 <code>/404</code>。</li></ul><p>这样就完成了。比如访问 <code>https://example.com/posts/2022-02-22.22.22.22/emacs-org-better-latex</code> 时应该会跳转到固有地址 <code>https://example.com/posts/2022-02-22.22.22.22/emacs-text-better-latex</code>。</p><h4 id=另一种方法><a class=h-a href=#%e5%8f%a6%e4%b8%80%e7%a7%8d%e6%96%b9%e6%b3%95>另一种方法</a></h4><p>这里再给出一种不依赖 Javascript 但有局限性的折衷方法（不推荐）：每次更新 slug 时，都手动将旧的 URL 路径添加到 aliases 中。</p><p>例如对于前面提到过的例子（其中 <code>emacs-org-better-latex</code> 是旧的 slug）则可以这样写导言区：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln id=hl-6-1><a class=lnlinks href=#hl-6-1>1</a></span><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-2><a class=lnlinks href=#hl-6-2>2</a></span><span class=cl><span class=w></span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>为 Emacs 的 Text Mode 优化 LaTeX 工作流</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-3><a class=lnlinks href=#hl-6-3>3</a></span><span class=cl><span class=w></span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>/posts/2022-02-22.22.22.22/emacs-text-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-4><a class=lnlinks href=#hl-6-4>4</a></span><span class=cl><span class=w></span><span class=nt>aliases</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-5><a class=lnlinks href=#hl-6-5>5</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-6><a class=lnlinks href=#hl-6-6>6</a></span><span class=cl><span class=w></span>- <span class=l>/posts/2022-02-22.22.22.22/emacs-org-better-latex</span><span class=w>
</span></span></span><span class=line><span class=ln id=hl-6-7><a class=lnlinks href=#hl-6-7>7</a></span><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span></code></pre></div><p>这种方法不涉及对服务端软件/平台的配置，但很难被自动化；而如果每次都要手动操作，则可能遗漏步骤。</p><h2 id=终><a class=h-a href=#%e7%bb%88>终</a></h2><p>对于个人博客网站，目前流行的方案仍然是 slug。含有 slug 的链接与标题相独立，也有一定的可读性，但却常常导致 404。</p><p>为了预防 404，最简单且足够稳定的方法是，为每个页面使用单独的编号，并指定它的 URL 为 <code>https://example.com/posts/编号</code> 或类似格式。这种方案也被广泛地应用于各大内容平台。<sup id=fnref:14><a href=#fn:14 class=footnote-ref role=doc-noteref>14</a></sup></p><p>本文也另外提出了一种利用编号来补足 slug 不稳定之处的方案，但缺点较多。</p><p>最后提到的结合编号与 slug 的方案则兼具各方优点，也是笔者最为推荐的，只是当前采用此方案的网站相对少见一些。<sup id=fnref:15><a href=#fn:15 class=footnote-ref role=doc-noteref>15</a></sup></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><del>“你似乎来到了没有知识存在的荒原”</del>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>比如假设有路径为 <code>/blog/latex-in-hugo</code> 的一篇文章，因添加了更多内容，更改标题之后路径变为 <code>/blog/latex-in-web</code> 。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>比如从散文区转移到文档区，或从文档区的一个分类转到另一个分类。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>slug 的原意为“铅字条”，即一种刻有文字的短小的金属条，出现于旧时代的印刷技术中。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>比如，从 <code>docs/A/foo-foo</code> 变为 <code>docs/B/foo-foo</code>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>这句话亦有常用的英文表述：Program to an interface, not an implementation.&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>实际上在未明确指定 URL 时，真正决定 URL 的是 md 文件在 content 目录中的位置；但为了管理方便，一般会使文档树的结构与 content 目录中的结构保持一致。&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p>固有地址可由 slug 或 url 配置。&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:9><p>至少相比单纯的 slug 方案，这确实给了用户更多选择，但无论哪种选择都不够好。&#160;<a href=#fnref:9 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:10><p>这并非我的独创。比如 Stack Overflow 就已经在使用这种方案了。&#160;<a href=#fnref:10 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:11><p><span class=hang-quote>“</span>几乎”的意思是，理论上来说，所需 HTML 文件的数量取决于 URL 路径的长度限制以及可用的字符种数，所以是一个非常巨大但仍然有限的整数值。&#160;<a href=#fnref:11 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:12><p>这里的 <code>/content</code> 是相对于你的 Hugo 工程的根目录而言的，而不是相对于你所使用的操作系统的 <code>/</code>；后文的 <code>/layouts</code> 等也是同理，不再赘述。&#160;<a href=#fnref:12 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:13><p>在 Javascript 中，注释符号是 <code>//</code>。&#160;<a href=#fnref:13 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:14><p>目前的例子有博客园、知乎等。&#160;<a href=#fnref:14 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:15><p>目前的例子有本站、Stack Overflow 等；基于 Discourse 的 Emacs China 当前也采用类似方案。&#160;<a href=#fnref:15 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=margin-full><section class=section><h2>相关阅读</h2><nav class="card-nav card-nav--2"><ul class=card-nav__list><li class="card card--1 card--1--row"><a href=/p/95e11a033/blog-latex-note-experience/ class=card__hover><div class="card__flex card__flex--half"><figure class="fig fig--w-tiny card__fig card__fig--half"><span class="img__frame img__frame--bg-light img__frame--box-shadow img__frame--pad-none"><span class="img__c img__c--t-symbol"><img alt=featured class=img--svg loading=lazy src=/p/95e11a033/blog-latex-note-experience/pic.featured/LaTeX-project-logo-bird.svg></span></span></figure><div class=card__content><div><div class=card__header><div class="meta meta--card meta--card--half"><ul class="ul--row meta__list"><li class="meta__item meta__list"><span class=meta__text>散文屋</span></li></ul></div><h3 class="card__title card__title--half">网页笔记/博客的 LaTeX 支持现状</h3></div><div class="md md--sans md--card md--card--half"><p>有那么一些人想在网页上使用 LaTeX，继而也就出现了一个天大的坑。</p></div></div></div></div></a></li><li class="card card--1 card--1--row"><a href=/p/42c4ae30a/e-note-text-vs-hand/ class=card__hover><div class="card__flex card__flex--half"><figure class="fig fig--w-tiny card__fig card__fig--half"><span class="img__frame img__frame--box-shadow img__frame--pad-none" style="display:flex;justify-content:center;align-items:center;background-image:linear-gradient(to right,#30373b,#708b8c)"><span class=img__c style=position:relative;width:100%;height:0;padding-bottom:86.2069%><img alt=featured class="img--ls img--ph lazyload" data-optimumx=auto data-sizes=auto data-srcset="/p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-128x.webp 128w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-143x.webp 143w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-159x.webp 159w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-165x.webp 165w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-178x.webp 178w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-199x.webp 199w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-222x.webp 222w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-248x.webp 248w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-276x.webp 276w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-308x.webp 308w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-344x.webp 344w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-384x.webp 384w, /p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-429x.webp 429w" height=142 src=/p/42c4ae30a/e-note-text-vs-hand/pic.featured/glenn-carstens-peters-P1qyEf1g0HU-unsplash-3304x2848--Right-165x.webp srcset=data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 width=165></span></span></figure><div class=card__content><div><div class=card__header><div class="meta meta--card meta--card--half"><ul class="ul--row meta__list"><li class="meta__item meta__list"><span class=meta__text>散文屋</span></li></ul></div><h3 class="card__title card__title--half">电子笔记方式：文本还是手写？</h3></div><div class="md md--sans md--card md--card--half"><p>两种方案的对比与方法论</p></div></div></div></div></a></li></ul></nav></section></div></article><footer class="page-footer margin-full"><div class="meta meta--foot"><nav><ul class=meta__list><li class="taxo-shape taxo-shape--category"><ul class=ul--row><li class=meta__hanging><a class="link link--nav" href=/categories/ title="All Categories"><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="m5.042 9.479 4.979-8.146L15 9.479zm9.666 9.167q-1.646.0-2.791-1.156-1.146-1.157-1.146-2.782.0-1.646 1.146-2.791 1.145-1.146 2.791-1.146 1.625.0 2.782 1.146 1.156 1.145 1.156 2.791.0 1.625-1.156 2.782-1.157 1.156-2.782 1.156zm-12.583-.417v-7.062h7.063v7.062z"/></svg></span></a></li><li class="meta__item meta__item--taxo"><a class="meta__text link link--nav" href=/categories/method/>方法论</a></li></ul></li><li class="taxo-shape taxo-shape--tag"><ul class=ul--row><li class=meta__hanging><a class="link link--nav" href=/tags/ title="All Tags"><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M3.188 10.542v5.875L.917 15.5zm4.062 7.75h-2.5V11.5zm1.958.75L4.146 5.333 14 1.75l5.042 13.729zm.021-10.5q.396.0.677-.282.282-.281.282-.677.0-.375-.282-.656-.281-.281-.677-.281-.375.0-.656.281t-.281.656q0 .396.281.677.281.282.656.282z"/></svg></span></a></li><li class="meta__item meta__item--taxo"><a class="meta__text link link--nav" href=/tags/hugo/>Hugo</a></li></ul></li></ul><ul class="ul--row meta__list"><li class=meta__item><a class="meta__icon link link--nav" href=/ title=Home rel=nofollow><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M3.167 17.667V7.438L10 2.292l6.833 5.146v10.229h-5.75v-5.646H8.896v5.646z"/></svg></span></a></li><li class=meta__item><span class=meta__separator>›</span></li><li class=meta__item><a class="meta__text link link--nav" href=/blog/ rel=nofollow>散文屋
</a><span class=meta__separator>›</span></li><li class=meta__item><a class="meta__text link link--nav" href=/p/feda224a0/website-link-management-prevent-404/ aria-current=page rel=nofollow>浅谈网站 URL 管理与预防 404</a></li></ul></nav><ul class="meta__list meta__list--date"><li class=meta__item><span class=meta__icon><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="m16.208 7.604-3.75-3.771 2.271-2.291 3.792 3.75zm-13.75 9.979v-3.75l8.771-8.771 3.75 3.75-8.75 8.771z"/></svg></span>
</span><time class=meta__text datetime=2024-05-17T00:00:00+08:00>May 17, 2024</time></li><li class=meta__item><span class=meta__icon><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M10 18.5q-1.771.0-3.323-.667-1.552-.666-2.698-1.812t-1.812-2.698Q1.5 11.771 1.5 10t.667-3.323q.666-1.552 1.812-2.698t2.698-1.812Q8.229 1.5 10 1.5t3.323.667q1.552.666 2.698 1.812t1.812 2.698Q18.5 8.229 18.5 10t-.667 3.323q-.666 1.552-1.812 2.698t-2.698 1.812Q11.771 18.5 10 18.5zm2.583-4.562 1.375-1.355-3-2.979V5.896H9.042v4.458z"/></svg></span>
</span><span class=meta__text>0:00 am</span></li><li class=meta__item><span class=meta__icon><a class="link link--nav" href=/authors/ title="All authors" rel=nofollow><span class='icon icon--material icon--tiny'><svg viewBox="0 0 20 20"><path d="M15.042 11.458V9.042h-2.417V7.208h2.417V4.792h1.833v2.416h2.417v1.834h-2.417v2.416zm-7.48-1.562q-1.479.0-2.489-1.011-1.011-1.01-1.011-2.489.0-1.5 1.011-2.5 1.01-1 2.489-1 1.5.0 2.511 1 1.01 1 1.01 2.5.0 1.479-1.01 2.489-1.011 1.011-2.511 1.011zM.688 16.917v-2.563q0-.792.406-1.406.406-.615 1.052-.948 1.312-.625 2.677-.938 1.365-.312 2.76-.312 1.417.0 2.792.323t2.667.927q.646.312 1.041.938.396.624.396 1.416v2.563z"/></svg></span>
</a></span><a class="meta__text link link--nav" href=/authors/clsty/ rel=nofollow>Clsty</a></li></ul></div><hr><nav class=page-nav><ul class=page-nav__list><li class=page-nav__li><a href=/p/25dbc0cc9/btrfs-simple-intro/ class="page-nav__link page-nav__link--prev link link--nav"><span class=page-nav__icon></span><div class=page-nav__title><span class=text>BTRFS 实践式快速入门</span></div><span class="page-nav__icon page-nav__icon--arrow"><span class='icon icon--material icon--normal'><svg viewBox="0 0 24 24"><path d="M9.075 18.675 2.4 12l6.675-6.675 1.075 1.05-4.875 4.875h16.15v1.5H5.275l4.85 4.875z"/></svg></span></span></a></li><li class=page-nav__li><a href=/p/61781423b/hyprland-use-tablet-or-laptop-as-extra-monitor/ class="page-nav__link page-nav__link--next link link--nav"><span class=page-nav__icon></span><div class=page-nav__title><span class=text>Hyprland 以平板/笔记本作扩展屏</span></div><span class="page-nav__icon page-nav__icon--arrow"><span class='icon icon--material icon--normal'><svg viewBox="0 0 24 24"><path d="m14.725 18.675-1.05-1.05 4.875-4.875H2.4v-1.5h16.15l-4.875-4.875 1.05-1.05 6.7 6.675z"/></svg></span></span></a></li></ul></nav><div class="meta meta--foot"><link href=https://art.celestialy.top/dist/Artalk.css rel=stylesheet><script src=https://art.celestialy.top/dist/Artalk.js></script><div id=Comments></div><script>Artalk.init({el:"#Comments",pageKey:"feda224a0",pageTitle:"浅谈网站 URL 管理与预防 404",server:"https://art.celestialy.top",site:"clsty-css",darkMode:"auto",gravatar:{mirror:"https://cravatar.cn/avatar/",default:"mp"}})</script></div></footer></div><footer id=l-footer class="l-box margin-full-half"><div class=l-footer__columns><div class="md md--footer md--frame footer__col"><h2>clsty 的网络空间站</h2><figure class="fig fig--w-tiny" id=fig-1><a class="img__frame img__frame--box-shadow" href=/about style="display:flex;justify-content:center;align-items:center;background-image:linear-gradient(to right,#333740,#6690dc)"><span class=img__c style=position:relative;width:100%;height:0;padding-bottom:35.7143%><img class="img--ls img--lqip lazyload" data-optimumx=auto data-sizes=auto data-srcset="/site/footer/about._production/avatar-460x164--Center-128x.webp 128w, /site/footer/about._production/avatar-460x164--Center-143x.webp 143w, /site/footer/about._production/avatar-460x164--Center-159x.webp 159w, /site/footer/about._production/avatar-460x164--Center-165x.webp 165w, /site/footer/about._production/avatar-460x164--Center-178x.webp 178w, /site/footer/about._production/avatar-460x164--Center-199x.webp 199w, /site/footer/about._production/avatar-460x164--Center-222x.webp 222w, /site/footer/about._production/avatar-460x164--Center-248x.webp 248w, /site/footer/about._production/avatar-460x164--Center-276x.webp 276w, /site/footer/about._production/avatar-460x164--Center-308x.webp 308w, /site/footer/about._production/avatar-460x164--Center-344x.webp 344w, /site/footer/about._production/avatar-460x164--Center-384x.webp 384w, /site/footer/about._production/avatar-460x164--Center-429x.webp 429w" height=59 src=data:image/webp;base64,UklGRqAAAABXRUJQVlA4IJQAAAAwBgCdASo3ABQAPyV0qEmnI6Ib/VQAcxJE84BgyA3Sir6Y46YmWooQvniL984np5EkEN8Y8dyI/3WAAP654Yuz59xy24p5KprpRxxhEQmsqQZJ0GjaGejMrtSxYmf/vYJBiSU5YrHPhSLv5Oh4zXstEm9DV97WCpt9tTkSKW8AJIdiluzjfGROvoNMeVegTsDuIwAA width=165></span></a></figure><p>2023-2024 © <a class="link link--text" href=/about>clsty</a> 版权所有</p></div><div class="md md--footer md--frame footer__col"><h2>全站内容共享协议</h2><figure class="fig fig--w-tiny" id=cc><a aria-label="Creative Commons 4.0 logo" class="img__frame img__frame--bg-none img__frame--box-shadow" href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans><span class="img__c img__c--t-symbol"><img alt="Creative Commons 4.0 logo" class=img--svg loading=lazy src=/site/footer/cc/by-nc-sa.svg></span></a></figure><p><a class="link link--text" href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans rel=external>CC BY-NC-SA 4.0</a>，除非另作说明</p></div><div class="md md--footer md--frame footer__col"><h2>相关链接</h2><ul><li><a class="link link--text" href=https://css.celestialy.top rel=external>本站（部署于 Cloudflare）</a></li><li><a class="link link--text" href=https://blog.celestialy.top rel=external>本站（部署于 GitHub）</a></li><li><a class="link link--text" href=https://arcn.celestialy.top/ rel=external>arCNiso 文档</a></li><li><a class="link link--text" href=https://alist.celestialy.top rel=external>存储分享（密码 clsty）</a></li></ul></div><div class="md md--footer md--frame footer__col"><h2>站点框架</h2><figure class="fig fig--w-tiny" id=hugo><a aria-label=Hugo class="img__frame img__frame--bg-none img__frame--box-shadow img__frame--pad-half" href=https://gohugo.io><span class="img__c img__c--t-symbol"><img alt=Hugo class=img--svg loading=lazy src=/site/footer/framework/Hugo.2.svg></span></a></figure><figure class="fig fig--w-text" id=perplex><a aria-label=Perplex class="img__frame img__frame--bg-none img__frame--box-shadow img__frame--pad-half" href=https://github.com/bowman2001/perplex><span class="img__c img__c--t-symbol"><svg viewBox="0 0 717 131"><g transform="translate(-13.3,-77.7)" aria-label="PERPLEX"><path d="m13.3 208V78h53.9q17.2.0 25.9 10.6 8.96 10.6 8.96 29.3t-8.96 29.3q-8.77 10.6-25.9 10.6H36.6v50.4zm23.3-70.7h28.2q5.97.0 9.33-3.17 3.55-3.36 3.55-10.6v-11.6q0-7.28-3.55-10.5-3.36-3.36-9.33-3.36H36.6z" fill="#c9177e"/><path d="m123 208V78h78.2v20.3h-54.9v34h48v19.8h-48v35.8h54.9v20.3z" fill="#8b8b8b"/><path d="m247 208h-23.3V78h53.9q17.2.0 25.9 10.5 8.96 10.5 8.96 29.1.0 14.7-5.6 24.5-5.6 9.52-16.4 13.1l23.7 53.2h-25.2l-21.5-51.3h-20.5zm28.2-70.7q5.97.0 9.33-3.17 3.55-3.17 3.55-10.6v-11.6q0-7.47-3.55-10.6-3.36-3.17-9.33-3.17H247v39.2z" fill="#0083c0"/><path d="m333 208V78h53.9q17.2.0 25.9 10.6 8.96 10.6 8.96 29.3t-8.96 29.3q-8.77 10.6-25.9 10.6h-30.6v50.4zm23.3-70.7h28.2q5.97.0 9.33-3.17 3.55-3.36 3.55-10.6v-11.6q0-7.28-3.55-10.5-3.36-3.36-9.33-3.36h-28.2z" fill="#8d8d8d"/><path d="m443 208V78h23.3v110H512v20.3z" fill="#00a88a"/><path d="m533 208V78h78.2v20.3h-54.9v34h48v19.8h-48v35.8h54.9v20.3z" fill="#8b8b8b"/><path d="m730 208h-26.9l-25.4-48.7h-2.43l-25 48.7h-25l37.1-66.6-35.3-63.7h26.7l23.1 45.2h2.61l23.5-45.2h25l-35.8 63.5z" fill="#ebb923"/></g></svg></span></a></figure><p><a class="link link--text" href=https://gohugo.io rel=external>Hugo</a> × <a class="link link--text" href=https://github.com/bowman2001/perplex rel=external>Perplex</a> [Apache 2.0]</p></div></div></footer></main><div id=l-overlay></div></div><script defer src=/js/foot.min.e64a7ab658572cb6d73b058cfbcca1e125e8928a3b71c7b63b88a377133bddbd.js integrity="sha256-5kp6tlhXLLbXOwWM+8yh4SXokoo7cce2O4ijdxM73b0="></script></body></html>